{
  "comments": [
    {
      "key": {
        "uuid": "45b5efd4_44a9e770",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 7,
      "author": {
        "id": 1012155
      },
      "writtenOn": "2020-06-23T10:14:05Z",
      "side": 1,
      "message": "This very general commit message made me thing that we remove the manual\nversion stamping from all plugin artifacts. But there are many other\nplugin build scripts that do not have the manual version stamping removed.\nThere\u0027s for example `gerrit-bazel-build-plugin-branch.sh` But in general,\nall the following look affected by manual version stamping\n\n$ grep Implementation-Version:.*MANIFEST jenkins/*.sh\njenkins/gerrit-bazel-build-account-plugin.sh:    echo -e \"Implementation-Version: $PLUGIN_VERSION\" \u003e MANIFEST.MF\njenkins/gerrit-bazel-build-its-plugin-branch.sh:    echo -e \"Implementation-Version: $PLUGIN_VERSION\" \u003e MANIFEST.MF\njenkins/gerrit-bazel-build-its-plugin.sh:    echo -e \"Implementation-Version: $PLUGIN_VERSION\" \u003e MANIFEST.MF\njenkins/gerrit-bazel-build-owners-plugin-branch.sh:    echo -e \"Implementation-Version: $PLUGIN_VERSION\" \u003e MANIFEST.MF\njenkins/gerrit-bazel-build-owners-plugin.sh:    echo -e \"Implementation-Version: $PLUGIN_VERSION\" \u003e MANIFEST.MF\njenkins/gerrit-bazel-build-plugin-branch.sh:    echo -e \"Implementation-Version: $PLUGIN_VERSION\" \u003e MANIFEST.MF\njenkins/gerrit-bazel-build-plugin-manual.sh:    echo -e \"Implementation-Version: $PLUGIN_VERSION\" \u003e MANIFEST.MF\njenkins/gerrit-bazel-build-plugin.sh:  echo -e \"Implementation-Version: $PLUGIN_VERSION\" \u003e MANIFEST.MF\njenkins/gerrit-mvn-build-plugin.sh:  echo -e \"Implementation-Version: $PLUGIN_VERSION\" \u003e MANIFEST.MF\njenkins/gerrit-sbt-build-app.sh:  echo -e \"Implementation-Version: $VERSION\" \u003e MANIFEST.MF\njenkins/gerrit-sbt-build-branch-plugin.sh:  echo -e \"Implementation-Version: $PLUGIN_VERSION\" \u003e MANIFEST.MF\njenkins/gerrit-sbt-build-plugin.sh:  echo -e \"Implementation-Version: $PLUGIN_VERSION\" \u003e MANIFEST.MF\n\nNot saying that we have to remove it from all of them. And maybe (not sure) the `-mvn-` and `-sbt-` scripts\nstill need it. But at least `jenkins/gerrit-bazel-build-plugin-branch.sh` is affected just the same.",
      "range": {
        "startLine": 7,
        "startChar": 7,
        "endLine": 7,
        "endChar": 57
      },
      "revId": "1ccebca5ba72e3785e83cb4c82ebbd5956844007",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b0d7bdd0_828af580",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 7,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2020-06-23T10:18:13Z",
      "side": 1,
      "message": "Right, it should be removed in all places that use Bazel. And stamping for Maven and SBT should stay. I guess, it is left over inthe CI from Maven time.",
      "parentUuid": "45b5efd4_44a9e770",
      "range": {
        "startLine": 7,
        "startChar": 7,
        "endLine": 7,
        "endChar": 57
      },
      "revId": "1ccebca5ba72e3785e83cb4c82ebbd5956844007",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ed08169d_5dc2e9a2",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 7,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2020-07-15T04:21:05Z",
      "side": 1,
      "message": "Done.",
      "parentUuid": "b0d7bdd0_828af580",
      "range": {
        "startLine": 7,
        "startChar": 7,
        "endLine": 7,
        "endChar": 57
      },
      "revId": "1ccebca5ba72e3785e83cb4c82ebbd5956844007",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b99c0bf7_5fd4fbaa",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-06-23T14:40:17Z",
      "side": 1,
      "message": "Has the stamping being fixed in Bazel? This workaround was introduced because Bazel was stamping all plugins with the Gerrit version. That was a long ago though and situation may have improved since then.",
      "revId": "1ccebca5ba72e3785e83cb4c82ebbd5956844007",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bcdaee30_9aedeec9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2020-06-23T14:45:13Z",
      "side": 1,
      "message": "Yes. There were multiple fixes. And the script was refactored and migrated from bash to Python to better portable. Can you answer the question. Why:\n\n  echo \"$PLUGIN_VERSION\" \u003e bazel-bin/plugins/{name}/$(basename $JAR-version)\n\nwe need that? plugin-manager plugin?",
      "parentUuid": "b99c0bf7_5fd4fbaa",
      "revId": "1ccebca5ba72e3785e83cb4c82ebbd5956844007",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e3dff0c7_89f2d07e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-06-23T15:17:27Z",
      "side": 1,
      "message": "There is meta-data needed to discover the plugin, and that needs to be exposed *outside* the .jar, for allowing to download a minimal set of information:\n- version of the plugin\n- JSON details of the plugin metadata (e.g. description)",
      "parentUuid": "bcdaee30_9aedeec9",
      "revId": "1ccebca5ba72e3785e83cb4c82ebbd5956844007",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cb0cdbd9_65653d8c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2020-06-28T20:43:58Z",
      "side": 1,
      "message": "See this CL: [1], with this Zuul-Job:[2], and this published final artifact: [3]m that contains this META-INF/MANIFEST.MF file:\n\n  Implementation-Version: 4a727dc\n  Manifest-Version: 1.0\n  Created-By: singlejar\n  Main-Class: Dummy\n  Gerrit-PluginName: gerrit-oauth-provider\n  Gerrit-Module: com.googlesource.gerrit.plugins.oauth.Module\n  Gerrit-HttpModule: com.googlesource.gerrit.plugins.oauth.HttpModule\n  Gerrit-InitStep: com.googlesource.gerrit.plugins.oauth.InitOAuth\n  Implementation-Title: Gerrit OAuth authentication provider\n  Implementation-URL: https://github.com/davido/gerrit-oauth-provider\n  Gerrit-ApiType: plugin\n  Gerrit-ApiVersion: 2.16.22-SNAPSHOT\n\nCan we remove it now? You still have not answered my question, what is hand made JSON artifact is used for and what would break, if we submit this change as is?\n\n[1] https://gerrit-review.googlesource.com/c/plugins/oauth/+/273552\n[2] https://ci.gerritcodereview.com/t/gerrit/build/dd68f7366121406bb3ab7df9f3c800e0\n[3] https://storage.googleapis.com/gerrit_zuul_logs2/52/273552/3/check/gerrit-plugin-build/dd68f73/artifacts/oauth.jar",
      "parentUuid": "e3dff0c7_89f2d07e",
      "revId": "1ccebca5ba72e3785e83cb4c82ebbd5956844007",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1c1f82a6_0cb89cc5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2020-06-28T21:29:11Z",
      "side": 1,
      "message": "\u003e See this CL: [1], with this Zuul-Job:[2], and this published final artifact: [3]m that contains this META-INF/MANIFEST.MF file:\n\u003e \n\u003e   Implementation-Version: 4a727dc\n\u003e   Manifest-Version: 1.0\n\u003e   Created-By: singlejar\n\u003e   Main-Class: Dummy\n\u003e   Gerrit-PluginName: gerrit-oauth-provider\n\u003e   Gerrit-Module: com.googlesource.gerrit.plugins.oauth.Module\n\u003e   Gerrit-HttpModule: com.googlesource.gerrit.plugins.oauth.HttpModule\n\u003e   Gerrit-InitStep: com.googlesource.gerrit.plugins.oauth.InitOAuth\n\u003e   Implementation-Title: Gerrit OAuth authentication provider\n\u003e   Implementation-URL: https://github.com/davido/gerrit-oauth-provider\n\u003e   Gerrit-ApiType: plugin\n\u003e   Gerrit-ApiVersion: 2.16.22-SNAPSHOT\n\u003e \n\u003e Can we remove it now? You still have not answered my question,\n\nI wrote:\nThere is meta-data needed to discover the plugin, and that needs to be exposed *outside* the .jar, for allowing to download a minimal set of information:\n\n- version of the plugin\n- JSON details of the plugin metadata (e.g. description)\n\nThose details are fetched for composing the data in the plugin-manager GUI.\n\n\u003e what is hand made JSON artifact is used for and what would break, if we submit this change as is?\n\nYes, the extraction of the version outside the jar is needed.",
      "parentUuid": "cb0cdbd9_65653d8c",
      "revId": "1ccebca5ba72e3785e83cb4c82ebbd5956844007",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    }
  ]
}