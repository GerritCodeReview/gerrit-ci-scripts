- job-template:
    name: 'plugin-owners-bazel-{branch}'
    description: "Plugin owners {branch} branch build with Bazel\n"
    defaults: plugin-template-bazel
    scm:
      - git:
         remotes:
           - origin:
               url: https://gerrit.googlesource.com/plugins/{name}
           - gerrit:
               url: https://gerrit.googlesource.com/gerrit
         branches:
           - origin/{branch}
         submodule:
           recursive: true
         skip-tag: true
    builders:
      - shell:
         !include-raw: gerrit-bazel-build-owners-plugin.sh
    publishers:
      - archive:
         artifacts: >
           bazel-bin/plugins/owners/owners.jar*,bazel-bin/plugins/owners/owners-autoassign.jar*

- job-template:
    name: 'plugin-owners-bazel-{branch}-{gerrit-branch}'
    class: plugins
    description: "Plugin owners {branch} branch Bazel build for Gerrit {gerrit-branch}\n"
    defaults: plugin-template-bazel
    scm:
      - git:
         remotes:
           - origin:
               url: https://gerrit.googlesource.com/plugins/{name}
           - gerrit:
               url: https://gerrit.googlesource.com/gerrit
         branches:
           - origin/{branch}
         submodule:
           recursive: true
         skip-tag: true
    project-name: plugins%2Fowners
    builders:
      - shell:
         !include-raw: gerrit-bazel-build-owners-plugin-branch.sh
      - shell:
         !include-raw: gerrit-bazel-get-project-info.sh
    publishers:
      - archive:
         artifacts: >
           bazel-bin/plugins/owners/owners.jar*,bazel-bin/plugins/owners/owners-autoassign.jar*

- project:
    name: owners
    jobs:
      - 'plugin-owners-bazel-{branch}':
          targets: 'plugins/owners plugins/owners-autoassign'
          branch:
            - master
            - stable-3.0
            - stable-2.16
            - stable-2.15
            - stable-2.14
