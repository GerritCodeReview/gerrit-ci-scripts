{
  "comments": [
    {
      "key": {
        "uuid": "2bec0964_c519e880",
        "filename": "jenkins-docker/master/config.xml",
        "patchSetId": 5
      },
      "lineNbr": 68,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2018-11-08T08:45:47Z",
      "side": 1,
      "message": "Why do we not want to pull the latest images?\nDo you want to rely on the job gerrit-ci-scripts-docker to build the images? If yes, we should think about, what happens if it fails to build an image (e.g. due to a flaky connection to a package repository). Since it throws away all images before building, this might cause missing docker images in the worst case.",
      "range": {
        "startLine": 68,
        "startChar": 24,
        "endLine": 68,
        "endChar": 34
      },
      "revId": "8f3297b7b253e5beeb0c1dfcdc467612ba910881",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4b519a7f_14b35a6f",
        "filename": "jenkins-docker/master/config.xml",
        "patchSetId": 5
      },
      "lineNbr": 68,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2018-11-08T09:00:41Z",
      "side": 1,
      "message": "Pulling the latest is very dangerous and slow.\nIdeally we should only rely on named tags and never ever use latest, but that is the future.\n\nWith regards to missing images, actually it is a lot better to NOT start a build because the image is missing rather than having a failed build for \"strange reasons\" and then after hours of investigations realise that it was just building with the wrong image :-(\n\nBut, of course, I am open to discussions :-)",
      "parentUuid": "2bec0964_c519e880",
      "range": {
        "startLine": 68,
        "startChar": 24,
        "endLine": 68,
        "endChar": 34
      },
      "revId": "8f3297b7b253e5beeb0c1dfcdc467612ba910881",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f99427a8_1f98253b",
        "filename": "jenkins-docker/master/config.xml",
        "patchSetId": 5
      },
      "lineNbr": 68,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2018-11-08T09:12:41Z",
      "side": 1,
      "message": "Yes, pulling latest is certainly not the best way to go.\nBut having a stand-still, because no build slave is available can also be very bad. I was thinking, we should implement some kind of fall-back. Something like having the previous image, which should usually have worked, still available, in case the build of the docker images fails.\n\nImagine the following example:\nThe job gerrit-ci-scripts-docker removes all images (docker system prune -af), then starts building the docker images and fails for some reason, when building the image containing the Jenkins master. The jenkins job stops then and all docker images for slaves are missing and nothing is built/verified, until somebody fixes that.\n\nThe gerrit-ci-scripts-docker job fails a lot and to me it seems to be a flakyness issue due to repositories, since it sometimes builds. So I think, we should work on the gerrit-ci-scripts-docker job, before we merge this change. What do you think?",
      "parentUuid": "4b519a7f_14b35a6f",
      "range": {
        "startLine": 68,
        "startChar": 24,
        "endLine": 68,
        "endChar": 34
      },
      "revId": "8f3297b7b253e5beeb0c1dfcdc467612ba910881",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ce878064_674adfa3",
        "filename": "jenkins-docker/master/config.xml",
        "patchSetId": 5
      },
      "lineNbr": 68,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2018-11-08T09:13:42Z",
      "side": 1,
      "message": "And of course we should also fix the issues which keep the images from building sometimes ;-)",
      "parentUuid": "f99427a8_1f98253b",
      "range": {
        "startLine": 68,
        "startChar": 24,
        "endLine": 68,
        "endChar": 34
      },
      "revId": "8f3297b7b253e5beeb0c1dfcdc467612ba910881",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fc74db5c_9473e5c4",
        "filename": "jenkins-docker/master/config.xml",
        "patchSetId": 5
      },
      "lineNbr": 68,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2018-11-08T09:22:07Z",
      "side": 1,
      "message": "The gerrit-ci-scripts-docker job is in the wrong place, it was an attempt to do the gerrit-ci-test \"in-place\" but fails because of system resources, connectivity, workload and more.\n\nI would work in this way:\n- have a baseline that works consistently\n- automate the verification of further changes and check against the baseline\n- make it better incrementally\n\nWe are far from perfect, but we are working towards it :-)",
      "parentUuid": "ce878064_674adfa3",
      "range": {
        "startLine": 68,
        "startChar": 24,
        "endLine": 68,
        "endChar": 34
      },
      "revId": "8f3297b7b253e5beeb0c1dfcdc467612ba910881",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6febafd2_9087acf9",
        "filename": "jenkins-docker/master/config.xml",
        "patchSetId": 5
      },
      "lineNbr": 68,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2018-11-08T11:52:00Z",
      "side": 1,
      "message": "Ah, ok as I understood it, the gerrit-ci-scripts-docker job was there to ensure that the Gerrit CI was always using the images built from top of the master branch.\n\nI agree then, that this should become part of the planned verification pipeline of gerrit-ci-scripts. Should we then remove the job for now, so that we don\u0027t run into the issue of having no images for the slaves? The only issue with that would then be that until we have a proper job for that, the images would . have to be updated manually, which would hopefully only be the case until next week :-).",
      "parentUuid": "fc74db5c_9473e5c4",
      "range": {
        "startLine": 68,
        "startChar": 24,
        "endLine": 68,
        "endChar": 34
      },
      "revId": "8f3297b7b253e5beeb0c1dfcdc467612ba910881",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "422b0836_0f56959e",
        "filename": "jenkins-docker/master/config.xml",
        "patchSetId": 5
      },
      "lineNbr": 155,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2018-11-08T08:45:47Z",
      "side": 1,
      "message": "Do you have a concrete reason to reduce the container cap?",
      "range": {
        "startLine": 155,
        "startChar": 20,
        "endLine": 155,
        "endChar": 21
      },
      "revId": "8f3297b7b253e5beeb0c1dfcdc467612ba910881",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9933989f_2dd5fc7f",
        "filename": "jenkins-docker/slave/Dockerfile",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2018-11-08T08:45:47Z",
      "side": 1,
      "message": "Is anybody still using this image? It can\u0027t even be built anymore, if I remember correctly. SHouldn\u0027t we rather remove it?",
      "revId": "8f3297b7b253e5beeb0c1dfcdc467612ba910881",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    }
  ]
}