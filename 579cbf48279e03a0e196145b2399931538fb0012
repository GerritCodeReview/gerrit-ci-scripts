{
  "comments": [
    {
      "key": {
        "uuid": "418629a5_bf989b6b",
        "filename": "jenkins/gerrit-bazel-build-its-plugin.sh",
        "patchSetId": 3
      },
      "lineNbr": 15,
      "author": {
        "id": 1006192
      },
      "writtenOn": "Jan 30, 2017 1:37:29 AM",
      "side": 1,
      "message": "Why a for loop? How many jars are you expecting to be produced?",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 15,
        "endChar": 74
      },
      "revId": "579cbf48279e03a0e196145b2399931538fb0012",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bf6d8df5_a938e546",
        "filename": "jenkins/gerrit-bazel-build-its-plugin.sh",
        "patchSetId": 3
      },
      "lineNbr": 15,
      "author": {
        "id": 1029953
      },
      "writtenOn": "Jan 30, 2017 2:55:06 AM",
      "side": 1,
      "message": "I was only following how it was done for the plugins shell script.",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 15,
        "endChar": 74
      },
      "revId": "579cbf48279e03a0e196145b2399931538fb0012",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c4eb9994_1467dd89",
        "filename": "jenkins/gerrit-bazel-build-its-plugin.sh",
        "patchSetId": 3
      },
      "lineNbr": 19,
      "author": {
        "id": 1011323
      },
      "writtenOn": "Jan 27, 2017 11:26:22 PM",
      "side": 1,
      "message": "Why is this needed at all and why it was in the bease version?\n\n  $ bazel build plugins/its-phabricator\n  INFO: Found 1 target...\n  Target //plugins/its-phabricator:its-phabricator up-to-date:\n    bazel-genfiles/plugins/its-phabricator/its-phabricator.jar\n  INFO: Elapsed time: 1.889s, Critical Path: 1.33s\n  $ jar -xf bazel-genfiles/plugins/its-phabricator/its-phabricator.jar META-INF/MANIFEST.MF\n  $ cat META-INF/MANIFEST.MF\n  Implementation-Version: 052af9e\n  [...]",
      "range": {
        "startLine": 17,
        "startChar": 4,
        "endLine": 19,
        "endChar": 46
      },
      "revId": "579cbf48279e03a0e196145b2399931538fb0012",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d414febd_b9101acc",
        "filename": "jenkins/gerrit-bazel-build-its-plugin.sh",
        "patchSetId": 3
      },
      "lineNbr": 19,
      "author": {
        "id": 1029953
      },
      "writtenOn": "Jan 28, 2017 5:04:40 AM",
      "side": 1,
      "message": "Not sure, im only following how it was done for gerrit\u0027s plugins. But gerrit ci is failing with permission denied https://gerrit-ci.gerritforge.com/job/plugin-its-phabricator-bazel-master/1/console",
      "range": {
        "startLine": 17,
        "startChar": 4,
        "endLine": 19,
        "endChar": 46
      },
      "revId": "579cbf48279e03a0e196145b2399931538fb0012",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b410ada7_c068ef3f",
        "filename": "jenkins/gerrit-bazel-build-its-plugin.sh",
        "patchSetId": 3
      },
      "lineNbr": 19,
      "author": {
        "id": 1006192
      },
      "writtenOn": "Jan 30, 2017 1:10:09 AM",
      "side": 1,
      "message": "This was historically needed with Buck builds because the automatic generation of the version number took the Gerrit version instead of the plugin one.\n\nLet me check if now with the Bazel build it is still the same or not.",
      "range": {
        "startLine": 17,
        "startChar": 4,
        "endLine": 19,
        "endChar": 46
      },
      "revId": "579cbf48279e03a0e196145b2399931538fb0012",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e099fe59_14e9041b",
        "filename": "jenkins/gerrit-bazel-build-its-plugin.sh",
        "patchSetId": 3
      },
      "lineNbr": 19,
      "author": {
        "id": 1006192
      },
      "writtenOn": "Jan 30, 2017 1:25:29 AM",
      "side": 1,
      "message": "Oh yes, see what Bazel generates when building for instance the uploadvalidator plugin on master:\n\nImplementation-Version: v2.13.5-2540-gbaac6e2-dirty\n\nThis is clearly the Gerrit version and NOT the uploadvalidator one.",
      "range": {
        "startLine": 17,
        "startChar": 4,
        "endLine": 19,
        "endChar": 46
      },
      "revId": "579cbf48279e03a0e196145b2399931538fb0012",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e3596923_80af17f6",
        "filename": "jenkins/gerrit-bazel-build-its-plugin.sh",
        "patchSetId": 3
      },
      "lineNbr": 19,
      "author": {
        "id": 1011323
      },
      "writtenOn": "Jan 30, 2017 8:49:13 AM",
      "side": 1,
      "message": "I do not see this poblem here:\n  \n$ bazel build plugins/uploadvalidator\nINFO: Found 1 target...\nuses or overrides a deprecated API.\nNote: Recompile with -Xlint:deprecation for details.\nNote: Some input files use unchecked or unsafe operations.\nNote: Recompile with -Xlint:unchecked for details.\nTarget //plugins/uploadvalidator:uploadvalidator up-to-date:\nbazel-genfiles/plugins/uploadvalidator/uploadvalidator.jar\nINFO: Elapsed time: 27.225s, Critical Path: 22.00s\n\n$ jar -xf bazel-genfiles/plugins/uploadvalidator/uploadvalidator.jar META-INF/MANIFEST.MF\n\n$ cat META-INF/MANIFEST.MF\nImplementation-Version: ef08747\nManifest-Version: 1.0\nGerrit-ApiVersion: 2.14-SNAPSHOT\nGerrit-ApiType: plugin\nGerrit-Module: com.googlesource.gerrit.plugins.uploadvalidator.Module\nGerrit-PluginName: uploadvalidator\nCreated-By: blaze-singlejar\nMain-Class: Dummy\nImplementation-Vendor: Gerrit Code Review\n\n$ cd ../uploadvalidator/\n$ git describe --always --match \"v[0-9].*\" --dirty\nef08747\n\nEvidently, it correctly retrieved the git vresion for uploadvalidator repository: ef08747.",
      "range": {
        "startLine": 17,
        "startChar": 4,
        "endLine": 19,
        "endChar": 46
      },
      "revId": "579cbf48279e03a0e196145b2399931538fb0012",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3d8e9dbb_c6f5929d",
        "filename": "jenkins/gerrit-bazel-build-its-plugin.sh",
        "patchSetId": 3
      },
      "lineNbr": 19,
      "author": {
        "id": 1011323
      },
      "writtenOn": "Jan 30, 2017 8:49:13 AM",
      "side": 1,
      "message": "I do not see this problem here:\n\n  $ jar -xf bazel-genfiles/plugins/uploadvalidator/uploadvalidator.jar META-INF/MANIFEST.MF\ndavido@linux-ucwl:~/projects/gerrit (master *%\u003e)$ cat META-INF/MANIFEST.MF\nImplementation-Version: 88182a6\nManifest-Version: 1.0\nGerrit-ApiVersion: 2.14-SNAPSHOT\nGerrit-ApiType: plugin\nGerrit-Module: com.googlesource.gerrit.plugins.uploadvalidator.Module\nGerrit-PluginName: uploadvalidator\nCreated-By: blaze-singlejar\nMain-Class: Dummy\nImplementation-Vendor: Gerrit Code Review",
      "range": {
        "startLine": 17,
        "startChar": 4,
        "endLine": 19,
        "endChar": 46
      },
      "revId": "579cbf48279e03a0e196145b2399931538fb0012",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "96a7e5e0_bb9f8578",
        "filename": "jenkins/gerrit-bazel-build-its-plugin.sh",
        "patchSetId": 3
      },
      "lineNbr": 19,
      "author": {
        "id": 1006192
      },
      "writtenOn": "Jan 30, 2017 8:58:47 AM",
      "side": 1,
      "message": "Define \"here\" :-)\nThe build takes a repo with two remotes, one named \u0027gerrit\u0027 and another \u0027origin\u0027. \n\nIn this scenario, the automatic generation of version get confused and takes the wrong one.\n\nIn your case possibly the repos are taken in a different way, maybe two separate clones and not two origins.",
      "range": {
        "startLine": 17,
        "startChar": 4,
        "endLine": 19,
        "endChar": 46
      },
      "revId": "579cbf48279e03a0e196145b2399931538fb0012",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0299e58e_41e95d5c",
        "filename": "jenkins/gerrit-bazel-build-its-plugin.sh",
        "patchSetId": 3
      },
      "lineNbr": 19,
      "author": {
        "id": 1011323
      },
      "writtenOn": "Jan 30, 2017 9:34:29 AM",
      "side": 1,
      "message": "\u003e Define \"here\" :-)\n\nOn my machine ;-)\n\n* 1. clone gerrit.\n* 2. clone plugin foo to any directory\n* 3. link plugin \"foo\" to gerrit/plugins/\n* 4. bazel build plugins/foo\n\nshould just work. I see, that menuextender on GerritForge CI has the right version. How was this created?\n\n* https://gerrit-ci.gerritforge.com/view/Plugins-master/job/plugin-menuextender-bazel-master/1/\n* https://gerrit-ci.gerritforge.com/view/Plugins-master/job/plugin-menuextender-bazel-master/1/\n* https://gerrit-ci.gerritforge.com/view/Plugins-master/job/plugin-menuextender-bazel-master/1/console\n\nSo let me do it locally: [1]. As you see it works.\n\n* [1] http://paste.openstack.org/show/596922/",
      "range": {
        "startLine": 17,
        "startChar": 4,
        "endLine": 19,
        "endChar": 46
      },
      "revId": "579cbf48279e03a0e196145b2399931538fb0012",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a91771fa_1eb634fb",
        "filename": "jenkins/gerrit-bazel-build-its-plugin.sh",
        "patchSetId": 3
      },
      "lineNbr": 19,
      "author": {
        "id": 1029953
      },
      "writtenOn": "Jan 30, 2017 9:36:35 AM",
      "side": 1,
      "message": "Its plugin have a different shell file to menuextender.",
      "range": {
        "startLine": 17,
        "startChar": 4,
        "endLine": 19,
        "endChar": 46
      },
      "revId": "579cbf48279e03a0e196145b2399931538fb0012",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7b85ace6_a16073e6",
        "filename": "jenkins/gerrit-bazel-build-its-plugin.sh",
        "patchSetId": 3
      },
      "lineNbr": 19,
      "author": {
        "id": 1006192
      },
      "writtenOn": "Jan 30, 2017 2:11:16 PM",
      "side": 1,
      "message": "I believe the problem is that when you have the \"tree\" mode, Jenkins defines job with two Git sources: origin and gerrit.\n\nThat scenario is different from your one with the symbolic link and that\u0027s why works for you but doesn\u0027t on the CI.",
      "range": {
        "startLine": 17,
        "startChar": 4,
        "endLine": 19,
        "endChar": 46
      },
      "revId": "579cbf48279e03a0e196145b2399931538fb0012",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f09ede60_8efacc85",
        "filename": "jenkins/gerrit-bazel-build-its-plugin.sh",
        "patchSetId": 3
      },
      "lineNbr": 19,
      "author": {
        "id": 1029953
      },
      "writtenOn": "Jan 31, 2017 4:21:04 PM",
      "side": 1,
      "message": "Would this change fix things?",
      "parentUuid": "7b85ace6_a16073e6",
      "range": {
        "startLine": 17,
        "startChar": 4,
        "endLine": 19,
        "endChar": 46
      },
      "revId": "579cbf48279e03a0e196145b2399931538fb0012",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}