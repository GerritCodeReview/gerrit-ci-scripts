{
  "comments": [
    {
      "key": {
        "uuid": "91a0942d_0166099b",
        "filename": "jenkins-docker/slave-bazel-nocache/Makefile",
        "patchSetId": 1
      },
      "lineNbr": 2,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-02-05T20:40:03Z",
      "side": 1,
      "message": "The image version should contain the bazel/buildifier versions also.\nSo that different branches of Gerrit can use different version of bazel.\nI don\u0027t believe we want to keep on releasing 2.14.x for every bazel upgrade we do, isn\u0027t it?",
      "range": {
        "startLine": 2,
        "startChar": 40,
        "endLine": 2,
        "endChar": 61
      },
      "revId": "c7ff888227e918ca988afb07d221b73f79cfe2ad",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1b4debe9_301d2dea",
        "filename": "jenkins-docker/slave-bazel-nocache/Makefile",
        "patchSetId": 1
      },
      "lineNbr": 2,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2019-02-05T20:51:09Z",
      "side": 1,
      "message": "I don\u0027t see why that would be helpful? Should we start producing all possible permutation, of debian/bazel/buildifier version docker images?",
      "parentUuid": "91a0942d_0166099b",
      "range": {
        "startLine": 2,
        "startChar": 40,
        "endLine": 2,
        "endChar": 61
      },
      "revId": "c7ff888227e918ca988afb07d221b73f79cfe2ad",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "23944eeb_6df460cc",
        "filename": "jenkins-docker/slave-bazel-nocache/Makefile",
        "patchSetId": 1
      },
      "lineNbr": 2,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-02-05T20:59:40Z",
      "side": 1,
      "message": "You are right, the buildifier is going to be too much :-)\nHowever, because the image name is \u0027gerrit-ci-slave-bazel\u0027 it makes sense to have the bazel version in the label of the image, isn\u0027t it?\n\nFor example, an image called GerritCodeReview/gerrit:2.16.4 is clearly the version 2.16.4 of Gerrit. Similarly an image called gerritforge/gerrit-ci-slave-bazel:0.19.0-debian-jessie-nocache is clearly the v0.19.0 of Bazel.",
      "parentUuid": "1b4debe9_301d2dea",
      "range": {
        "startLine": 2,
        "startChar": 40,
        "endLine": 2,
        "endChar": 61
      },
      "revId": "c7ff888227e918ca988afb07d221b73f79cfe2ad",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6bf8f42b_bdf2da7b",
        "filename": "jenkins-docker/slave-bazel-nocache/Makefile",
        "patchSetId": 1
      },
      "lineNbr": 2,
      "author": {
        "id": 1065256
      },
      "writtenOn": "2019-02-06T09:09:46Z",
      "side": 1,
      "message": "I agree with Luca. If we come into a situation that one branch can\u0027t be built anymore with a newer version of bazel, we should maintain multiple versions of the bazel-slave. We would then have to use multiple labels to assign the slave-images correctly. This would also consume more space on the docker nodes of course, if multiple images have to be available.\n\nWe should maybe also always print the bazel/buildifier versions in the build log of each build. This would make it a lot easier to reproduce the builds.",
      "parentUuid": "23944eeb_6df460cc",
      "range": {
        "startLine": 2,
        "startChar": 40,
        "endLine": 2,
        "endChar": 61
      },
      "revId": "c7ff888227e918ca988afb07d221b73f79cfe2ad",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a0e9d506_0bc591bd",
        "filename": "jenkins-docker/slave-bazel-nocache/Makefile",
        "patchSetId": 1
      },
      "lineNbr": 12,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-02-05T20:40:03Z",
      "side": 1,
      "message": "Do we want to build all the versions of Bazel we need?",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 12,
        "endChar": 21
      },
      "revId": "c7ff888227e918ca988afb07d221b73f79cfe2ad",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7eeee459_5a3b2dc4",
        "filename": "jenkins-docker/slave-bazel-nocache/Makefile",
        "patchSetId": 1
      },
      "lineNbr": 12,
      "author": {
        "id": 1011323
      },
      "writtenOn": "2019-02-05T20:51:09Z",
      "side": 1,
      "message": "We do not build Bazel here. We build Docker image and download pre-built version of Bazel in that image. Heer we do it without pre-warming of build cache.\n\nWe could skip that step and just use Docker Image without pre-installed Bazel, but then we would have issue with cold Bazel caches and CI build would take much longer. The only alternative I see, is to use remote bazel cache.",
      "parentUuid": "a0e9d506_0bc591bd",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 12,
        "endChar": 21
      },
      "revId": "c7ff888227e918ca988afb07d221b73f79cfe2ad",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a18bdd8f_4ca4df0e",
        "filename": "jenkins-docker/slave-bazel-nocache/Makefile",
        "patchSetId": 1
      },
      "lineNbr": 12,
      "author": {
        "id": 1006192
      },
      "writtenOn": "2019-02-05T20:59:40Z",
      "side": 1,
      "message": "A remote bazel cache will be done over the Internet isn\u0027t it? It is going to be slow anyway. This image contains \"bazel without cache\" and there is another one that does the warm-up.\n\nI\u0027ve built this image because during releases I don\u0027t want to use any cache, I want to make a full build and have a very slim image to do it.\n\nWe can keep the pre-warm cache image and it\u0027s fine for now. I just want to make sure to have \"something\" for building v2.14 of Gerrit :-)",
      "parentUuid": "7eeee459_5a3b2dc4",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 12,
        "endChar": 21
      },
      "revId": "c7ff888227e918ca988afb07d221b73f79cfe2ad",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    }
  ]
}